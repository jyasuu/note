在 Rust 裡，`pub(crate) fn` 是一種**可見性（visibility）修飾**，作用是控制這個函式的「能被誰使用」。

---

## ✔ 基本概念

Rust 的函式預設是 `private`：

```rust
fn foo() {}
```

代表：只能在同一個 module（mod）裡使用。

---

## ✔ `pub` vs `pub(crate)` vs `pub(super)` vs `pub(in ...)`

| 語法                   | 可見範圍          | 說明                       |
| -------------------- | ------------- | ------------------------ |
| `pub`                | 全世界（任何 crate） | 完全公開                     |
| `pub(crate)`         | **整個 crate**  | 只有同一個 crate 裡的 module 能用 |
| `pub(super)`         | 上一層 module    | 讓父 module 能使用            |
| `pub(in some::path)` | 指定路徑          | 更細的可見性控制                 |

---

## ✔ `pub(crate) fn` 是什麼？

它表示：

> 這個函式可以在 **同一個 crate 的任何 module 裡使用**，但不會暴露給 crate 外部。

### 範例

```rust
// src/lib.rs
mod a;
mod b;
```

```rust
// src/a.rs
pub(crate) fn hello() {
    println!("hello");
}
```

```rust
// src/b.rs
use crate::a::hello;

pub fn run() {
    hello(); // ✔ 可以呼叫
}
```

如果外部 crate 嘗試使用：

```rust
other_crate::a::hello(); // ❌ 不行，因為不是 pub
```

---

## ✔ 用途

### 1. 想在 crate 內共用，但不暴露給外部

e.g. 內部工具函式、helper、internal API。

### 2. 保持 library 的 public API 最小

有利於 ABI/stability、避免過度暴露。

---

## ✔ 何時用 `pub(crate)`？

例如你寫 library：

```rust
pub struct Server;

impl Server {
    pub fn start() {
        internal_init(); // crate-level internal call
    }
}

pub(crate) fn internal_init() {
    // 不想被外部使用
}
```

---

如果你想，我可以幫你補：

* `pub` 可見性完整圖示
* module visibility 最佳實務
* 在大型專案（especially systems programming）如何使用這些修飾

你要哪一種延伸？
